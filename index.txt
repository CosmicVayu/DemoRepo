This is the code for version 2 software changed now 14 Nov
